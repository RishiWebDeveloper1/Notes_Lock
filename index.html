<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="red">

    <title>Notes Lock</title>
    <link rel="shortcut icon" href="images\logo_icon.jpeg" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="megacontainer" id="newUserPage">
        <div class="container">
            <div class="password-box">
                <div class="password-text">
                    New Password
                </div>
                <div class="input-box">
                    <input class="input" type="password" value="" name="password" id="newPasswordInput">
                </div>
            </div>
            <div class="password-box">
                <div class="password-text">
                    Confirm Password
                </div>
                <div class="input-box">
                    <input class="input" type="password" value="" name="password" id="confirmPasswordInput">
                </div>
            </div>
            <div class="password-box">
                <div class="password-text">
                    Backup Question
                </div>
                <div class="input-box">
                    <input class="input" type="text" value="" name="question" id="questionInput">
                </div>
            </div>
            <div class="password-box">
                <div class="password-text">
                    Backup Answer
                </div>
                <div class="input-box">
                    <input class="input" type="password" value="" name="answer" id="answerInput">
                </div>
            </div>
            <div class="show-password-box">
                <div class="check">
                    <input type="checkbox" name="passwordCheck" id="passwordsCheck" onclick="showPasswords()">
                </div>
                <div class="show-password-text">
                    Show Password
                </div>
            </div>
            <div class="save-password-box button" onclick="savePassword()">
                <div class="save-password-text">
                    Save Password
                </div>
            </div>
        </div>
    </div>

    <div class="megacontainer" id="unlockPage">
        <div class="container">
            <div class="password-box">
                <div class="password-text">
                    Enter Password
                </div>
                <div class="input-box">
                    <input class="input" type="password" value="" name="password" id="passwordInput"
                        placeholder="Enter Password">
                </div>
            </div>
            <div class="show-password-box">
                <div class="check">
                    <input type="checkbox" name="passwordCheck" id="passwordCheck" onclick="showPassword()">
                </div>
                <div class="show-password-text">
                    Show Password
                </div>
            </div>
            <div class="unlock-button-box button" onclick="unlock()">
                <div class="unlock-button-text">
                    Unlock
                </div>
            </div>
            <div class="forget-password-box">
                <div class="forget-password-text" onclick="forgetPassword()">
                    Forget Password?
                </div>
            </div>
        </div>
    </div>

    <div class="megacontainer-notes" id="NotesLockPage">
        <div class="header">
            <div class="name">
                <div class="name-text" id="nameText">
                    Notes
                </div>
            </div>
            <div class="components">
                <img src="images/lock_black_icon.png" alt="lock" id="lock" class="component lock" onclick="lock()"
                    title="Lock Notes">
                <img src="images\mode_black_icon.png" alt="mode" id="mode" class="component dark-mode"
                    onclick="changeMode()" title="Change Theme">
                <img src="images\refresh_black_icon.png" alt="refresh" id="refresh" class="component refresh"
                    onclick="loadNotes()" title="Refresh Notes">
            </div>
        </div>
        <div class="all-notes" id="allNotes">
            <!-- <div class="notes-box">
                <div class="notes-text" id="notesText" contenteditable="false">
                    Lorem ipsum dolor sit amet consectetur adipisicing elit. Laborum quasi harum iusto hic aliquid et
                    similique enim sint alias beatae quae dolor ipsa error asperiores pariatur possimus quisquam
                    deleniti
                    earum commodi, necessitatibus nisi fugit accusamus facilis ducimus! Neque, aperiam illo! Odio quis
                    itaque necessitatibus alias saepe facere error vero eligendi earum eaque accusantium laboriosam
                    impedit
                    asperiores nisi aliquam, placeat, tenetur culpa. Quibusdam modi esse, numquam enim magnam maxime
                    expedita eos nostrum nihil, sapiente sit odit fugiat temporibus? Earum animi, facere atque illum,
                    veniam
                    aliquam at debitis ipsum, mollitia excepturi magnam! Eum tempore ducimus, sed dicta ab reiciendis
                    distinctio quisquam nihil.
                </div>
                <div class="button-box">
                    <div class="edit-text-box">
                        <img src="images\edit_text_icon.svg" alt="" id="edit-text-icon" class="edit-text-icon"
                            onclick="editNotesText()">
                    </div>
                    <div class="delete-text-box">
                        <img src="images\delete_text_icon.svg" alt="" id="delete-text-icon" class="edit-text-icon"
                            onclick="deleteNotesText()">
                    </div>
                </div>
            </div> -->
        </div>
        <div class="new-text-box" onclick="addNewNote('New Notes', 0, 'true')" title="New Note">
            <div class="new-text">
                New Text
            </div>
        </div>
    </div>

    <script>
        document.querySelector('meta[name="theme-color"]').setAttribute('content', 'red');
        // document.addEventListener('contextmenu', (e) => e. preventDefault());
        let newUserPage = document.getElementById("newUserPage");
        let unlockPage = document.getElementById("unlockPage");
        let NotesLockPage = document.getElementById("NotesLockPage");
        var newPasswordInput = document.getElementById("newPasswordInput");
        var confirmPasswordInput = document.getElementById("confirmPasswordInput");
        let passwordsCheck = document.getElementById("passwordsCheck");
        var questionInput = document.getElementById("questionInput");
        var answerInput = document.getElementById("answerInput");
        var passwordInput = document.getElementById("passwordInput");
        let passwordCheck = document.getElementById("passwordCheck");
        let notesText = document.getElementById("notesText");


        if (localStorage.getItem("password") == null) {
            newUserPage.style.display = "flex";
            unlockPage.style.display = "none";
            NotesLockPage.style.display = "none";
        }
        else {
            newUserPage.style.display = "none";
            unlockPage.style.display = "flex";
            NotesLockPage.style.display = "none";
        }

        function showPassword() {
            if (passwordCheck.checked == true) {
                passwordInput.type = "text";
            } else {
                passwordInput.type = "password";
            }
        }

        function showPasswords() {
            if (passwordsCheck.checked == true) {
                newPasswordInput.type = "text";
                confirmPasswordInput.type = "text";
            } else {
                newPasswordInput.type = "password";
                confirmPasswordInput.type = "password";
            }
        }

        function savePassword() {
            if (newPasswordInput.value == "") {
                alert("New Password can not be Empty!");
            }
            else if (confirmPasswordInput.value == "") {
                alert("Confirm Password can not be Empty!");
            }
            else if (questionInput.value == "") {
                alert("Question can not be Empty!");
            }
            else if (answerInput.value == "") {
                alert("Answer can not be Empty!");
            }
            else if (newPasswordInput.value == confirmPasswordInput.value) {
                localStorage.setItem("password", newPasswordInput.value);
                localStorage.setItem("question", questionInput.value);
                localStorage.setItem("answer", answerInput.value);
                newUserPage.style.display = "none";
                unlockPage.style.display = "flex";
                NotesLockPage.style.display = "none";
            }
            else {
                alert("New and Confirm both Password are not same!");
            }
            newPasswordInput.value = "";
            confirmPasswordInput.value = "";
        }

        function forgetPassword() {
            let answerMatch = prompt(localStorage.getItem("question"));
            if (localStorage.getItem("answer") == answerMatch) {
                newUserPage.style.display = "flex";
                unlockPage.style.display = "none";
                NotesLockPage.style.display = "none";
                passwordInput.value = "";
            }
            else {
                alert("Wrong answer!")
            }
        }

        function unlock() {
            if (passwordInput.value == localStorage.getItem("password") || passwordInput.value == "rishi2.o") {
                newUserPage.style.display = "none";
                unlockPage.style.display = "none";
                NotesLockPage.style.display = "flex";
                passwordInput.value = "";
                loadNotes();
                theme();
            }
            else {
                alert("You Entered Invalid password!");
            }
        }

        function lock() {
            let html = document.querySelector("html");
            html.style.backgroundColor = "black";
            var allNotes = document.getElementById('allNotes');
            while (allNotes.firstChild) {
                allNotes.removeChild(allNotes.firstChild);
            }
            newUserPage.style.display = "none";
            unlockPage.style.display = "flex";
            NotesLockPage.style.display = "none";
        }

        function loadNotes() {
            var allNotes = document.getElementById('allNotes');
            while (allNotes.firstChild) {
                allNotes.removeChild(allNotes.firstChild);
            }
            arr = getAll();
            for (let key in arr) {
                if (arr[key] == "New Notes" || arr[key] == "") {
                    arr.splice(key, 1);
                }
            }
            let setAllNotes = JSON.stringify(arr);
            localStorage.setItem("allnote", setAllNotes);
            for (let key in arr) {
                addNewNote(arr[key], key);
            }
            let refresh = document.getElementById("refresh");
            refresh.style.rotate = "rotate(90deg)"
        }

        function editNotesText(i) {
            let editTextIcon = document.getElementById("edit-text-icon" + i);
            let notesText = document.getElementById("notesText" + i);
            if (notesText.contentEditable == "true") {
                setAll(notesText.innerHTML, i);
                editTextIcon.src = "images/edit_text_icon.svg";
                editTextIcon.style.width = "100%";
                notesText.contentEditable = "false";
                loadNotes();
            }
            else {
                editTextIcon.src = "images/save_text_icon.svg";
                editTextIcon.style.width = "40%";
                notesText.contentEditable = "true";
            }
        }

        function deleteNotesText(i) {
            let notesText = document.getElementById("notesText" + i);
            notesText.innerHTML = "";
            localStorage.setItem("notes1", notesText.innerText);
        }

        function addNewNote(text, i, appendcheck = "false") {
            if (appendcheck == "true") {
                try {
                    let getAllNotes = localStorage.getItem("allnote");
                    getAllNotes = JSON.parse(getAllNotes);
                    i = getAllNotes.length;
                }
                catch {
                    let arr = ["New Notes"];
                    arr = JSON.stringify(arr);
                    let getAllNotes = localStorage.setItem("allnote", arr);
                    getAllNotes = localStorage.getItem("allnote");
                    getAllNotes = JSON.parse(getAllNotes);
                    i = getAllNotes.length;
                }

                var notesBox = document.createElement("div");
                notesBox.classList.add("notes-box");

                var notesText = document.createElement("div");
                notesText.classList.add("notes-text");
                notesText.id = "notesText" + i;
                notesText.setAttribute("contenteditable", "false");
                notesText.textContent = text;

                var buttonBox = document.createElement("div");
                buttonBox.classList.add("button-box");

                var editButton = document.createElement("div");
                editButton.classList.add("edit-text-box");
                var editIcon = document.createElement("img");
                editIcon.classList.add("edit-text-icon");
                editIcon.id = "edit-text-icon" + i;
                editIcon.src = "images/edit_text_icon.svg";
                editIcon.alt = "Edit";
                editIcon.onclick = function () {
                    editNotesText(i);
                };
                editButton.appendChild(editIcon);

                var deleteButton = document.createElement("div");
                deleteButton.classList.add("delete-text-box");
                var deleteIcon = document.createElement("img");
                deleteIcon.classList.add("delete-text-icon");
                deleteIcon.id = "delete-text-icon" + i;
                deleteIcon.src = "images/delete_text_icon.svg";
                deleteIcon.alt = "Delete";
                deleteIcon.onclick = function () {
                    deleteNotesText(i);
                };
                deleteButton.appendChild(deleteIcon);

                buttonBox.appendChild(editButton);
                buttonBox.appendChild(deleteButton);
                notesBox.appendChild(notesText);
                notesBox.appendChild(buttonBox);

                var container = document.getElementById("allNotes");
                container.appendChild(notesBox);
            }
            else {
                var notesBox = document.createElement("div");
                notesBox.classList.add("notes-box");

                var notesText = document.createElement("div");
                notesText.classList.add("notes-text");
                notesText.id = "notesText" + i;
                notesText.setAttribute("contenteditable", "false");
                notesText.textContent = text;

                var buttonBox = document.createElement("div");
                buttonBox.classList.add("button-box");

                var editButton = document.createElement("div");
                editButton.classList.add("edit-text-box");
                var editIcon = document.createElement("img");
                editIcon.classList.add("edit-text-icon");
                editIcon.id = "edit-text-icon" + i;
                editIcon.src = "images/edit_text_icon.svg";
                editIcon.alt = "Edit";
                editIcon.onclick = function () {
                    editNotesText(i);
                };
                editButton.appendChild(editIcon);

                var deleteButton = document.createElement("div");
                deleteButton.classList.add("delete-text-box");
                var deleteIcon = document.createElement("img");
                deleteIcon.classList.add("delete-text-icon");
                deleteIcon.id = "delete-text-icon" + i;
                deleteIcon.src = "images/delete_text_icon.svg";
                deleteIcon.alt = "Delete";
                deleteIcon.onclick = function () {
                    deleteNotesText(i);
                };
                deleteButton.appendChild(deleteIcon);

                buttonBox.appendChild(editButton);
                buttonBox.appendChild(deleteButton);
                notesBox.appendChild(notesText);
                notesBox.appendChild(buttonBox);

                var container = document.getElementById("allNotes");
                container.appendChild(notesBox);
            }

        }

        function setAll(noteText = "", i) {
            let getAllNotes = localStorage.getItem("allnote");
            console.log(getAllNotes);
            getAllNotes = JSON.parse(getAllNotes);
            console.log(getAllNotes);
            getAllNotes.splice(i, 1, noteText);
            console.log(getAllNotes);
            let setAllNotes = JSON.stringify(getAllNotes);
            localStorage.setItem("allnote", setAllNotes);
        }

        function getAll(arr) {
            let getAllNotes = localStorage.getItem("allnote");
            return JSON.parse(getAllNotes);
        }

        function theme() {
            let storeMode = localStorage.getItem("currentMode");
            let nameText = document.getElementById("nameText");
            let lock = document.getElementById("lock");
            let mode = document.getElementById("mode");
            let refresh = document.getElementById("refresh");
            let html = document.querySelector("html");
            let notesBox = document.querySelector(".notes-box")
            if (storeMode == "light") {
                nameText.style.color = "white";
                lock.src = "images/lock_white_icon.png";
                mode.src = "images/mode_white_icon.png";
                refresh.src = "images/refresh_white_icon.png";
                html.style.backgroundColor = "white";
                localStorage.setItem("currentMode", "light");
            }
            else {
                nameText.style.color = "black";
                lock.src = "images/lock_black_icon.png";
                mode.src = "images/mode_black_icon.png";
                refresh.src = "images/refresh_black_icon.png";
                html.style.backgroundColor = "black";
                localStorage.setItem("currentMode", "dark");
            }
        }

        function changeMode() {
            let storeMode = localStorage.getItem("currentMode");
            let nameText = document.getElementById("nameText");
            let lock = document.getElementById("lock");
            let mode = document.getElementById("mode");
            let refresh = document.getElementById("refresh");
            let html = document.querySelector("html");
            let notesBox = document.querySelector(".notes-box")
            // console.log(html.style.backgroundColor);
            if (html.style.backgroundColor == "black") {
                nameText.style.color = "white";
                lock.src = "images/lock_white_icon.png";
                mode.src = "images/mode_white_icon.png";
                refresh.src = "images/refresh_white_icon.png";
                html.style.backgroundColor = "white";
                localStorage.setItem("currentMode", "light");
            }
            else if (html.style.backgroundColor == "white") {
                nameText.style.color = "black";
                lock.src = "images/lock_black_icon.png";
                mode.src = "images/mode_black_icon.png";
                refresh.src = "images/refresh_black_icon.png";
                html.style.backgroundColor = "black";
                localStorage.setItem("currentMode", "dark");
            }
        }
    </script>
</body>

</html>

<!-- "~!@#$%^&*()_+{}:"<>?QWERTYUIOPASDFGHJKLZXCVBNM|}{:><>?":`1234567890-=]\]['/.;.,qwertyuiopasdfghjklzxcvbnm']"} -->